---
import {
  getLangFromUrl,
  useTranslations,
  useTranslatedPath,
} from "../i18n/utils";
import { languages } from "../i18n/ui";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);
---

<nav class="nav" aria-label="Primary Navigation">
  <img src="/Logo.png" alt="Logo" class="nav__logo" />
  <div class="nav__container">
    <ul class="nav__list">
      <li class="nav__item">
        <a href={translatePath("#services")} class="nav__link">
          {t("nav.service")}
        </a>
      </li>
      <li class="nav__item">
        <a href="#feature" class="nav__link">{t("nav.feature")} </a>
      </li>
      <li class="nav__item">
        <a href="#product" class="nav__link">{t("nav.product")} </a>
      </li>
      <li class="nav__item">
        <a href="#testimonial" class="nav__link">{t("nav.testimonial")} </a>
      </li>
      <li class="nav__item">
        <a href="#faq" class="nav__link">{t("nav.faq")} </a>
      </li>
    </ul>
  </div>
  <div class="nav__button-container">
    <button class="nav__button-login">Login</button>
    <button class="nav__button-signup">Sign up</button>
    <select id="language-select" class="nav__button-select">
      {
        Object.entries(languages).map(([langCode, label]) => (
          <option
            value={langCode}
            selected={langCode === lang}
            class="nav__button-option"
          >
            {langCode.toLocaleUpperCase()}
          </option>
        ))
      }
    </select>
  </div>
</nav>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const selectElement = document.getElementById("language-select");

    if (selectElement) {
      selectElement.addEventListener("change", (event) => {
        const target = event.target as HTMLSelectElement;
        if (target) {
          const selectedLang = target.value;
          const currentPath = window.location.pathname;
          if (selectedLang === "en") {
            window.location.href = "/";
            return;
          }
          window.location.href = `/${selectedLang}${currentPath}`;
        }
      });
    }
  });
</script>

<style>
  .nav {
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    padding: 1rem 2rem;
    width: 100%;
    max-width: 1440px;
    height: 84px;
    background-color: var(--neutral-silver);
    margin: 0 auto;
  }

  .nav__logo {
    width: 154px;
    height: 24px;
  }

  .nav__container {
    display: flex;
    gap: 1rem;
  }

  .nav__list {
    display: flex;
    gap: 2.5rem;
    margin: 0;
    padding: 0;
  }

  .nav__item {
    list-style: none;
  }

  .nav__link {
    text-decoration: none;
    color: #18191f;
    font-size: var(--font-size-body2);
    line-height: var(--line-height-body2);
  }

  .nav__button {
    padding: 0.5rem 1rem;
    background-color: #f5f5f5;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  .nav__button-container {
    display: flex;
    width: 182px;
    height: 40px;
    justify-content: center;
    align-items: center;
    margin: 0;
    gap: 14px;
  }

  .nav__button-login {
    width: 77px;
    height: 40px;
    background-color: transparent;
    border: none;
    color: #4caf4f;
    font-size: 14px;
    line-height: 20px;
  }

  .nav__button-signup {
    width: 91px;
    height: 40px;
    background-color: #4caf4f;
    border: none;
    color: #ffffff;
    font-size: 14px;
    line-height: 20px;
    border-radius: 6px;
  }

  .nav__button-select {
    width: 40px;
    height: 40px;
    background-color: #f5f5f5;
    border: none;
    border-radius: 6px;
    color: #4caf4f;
    font-size: 14px;
    line-height: 20px;
    cursor: pointer;
  }

  .nav__button-option {
    font-size: 14px;
    line-height: 20px;
    cursor: pointer;
  }
</style>
